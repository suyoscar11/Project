When you have uncertainties in your data (some points are more trustworthy than others), you want points with small uncertainties to influence the fit more.

This is called a weighted least squares fit.

The formula:



ğ‘‹
X is a vector: 

â€‹
  (intercept and slope)

ğ‘Œ
Y is your column of 
ğ‘¦
y data

ğ´
A is a matrix with columns: all ones (for intercept), and all x values

ğ¶
C is a diagonal matrix whose diagonal entries are the variances (
â€‹
 ) of each y value

What does this formula do?
Weights:
Multiplies everything by 
ğ¶
âˆ’
1
C 
âˆ’1
  (the inverse of the uncertainties squared) so â€œgoodâ€ data counts more.

Best Match:
Tries to find the combination of 
ğ‘š
m and 
ğ‘
b that makes the predicted y-values as close as possible to your data y-values, with those weights.

How does the formula find the best-fit?
It minimizes the chi-squared:























